name: Actualizar Pronósticos Cada 12 Horas

on:
  schedule:
    # Se ejecuta cada 12 horas (a las 8 AM y 8 PM UTC)
    - cron: '0 8,20 * * *'
  # También se puede ejecutar manualmente
  workflow_dispatch:

jobs:
  actualizar-pronosticos:
    runs-on: ubuntu-latest
    
    steps:
    # 1. Descargar el repositorio
    - name: Descargar código
      uses: actions/checkout@v3
      
    # 2. Configurar Python
    - name: Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    # 3. Instalar dependencias
    - name: Instalar paquetes necesarios
      run: |
        pip install pandas numpy matplotlib gspread statsmodels
        
    # 4. Crear script Python
    - name: Crear script de ejecución
      run: |
        cat > ejecutar_pronosticos.py << 'EOF'
        # Aquí pegarás TODO tu código de Colab
        # (El que tienes en modelo_sarima.py)
        EOF
        
    # 5. Modificar el script para guardar en GitHub
    - name: Modificar para guardar en repo
      run: |
        # Aquí agregarías código que guarde las imágenes
        # directamente en la carpeta del repositorio
        
    # 6. Ejecutar el script
    - name: Ejecutar pronósticos
      env:
        GOOGLE_SHEETS_URL: ${{ secrets.GOOGLE_SHEETS_URL }}
      run: python ejecutar_pronosticos.py
      
    # 7. Subir los cambios a GitHub
    - name: Subir cambios a GitHub
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add .
        git commit -m "Actualización automática de pronósticos $(date)"
        git push
